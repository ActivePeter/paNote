group_auth:
  login:
    req:
      id: String
      pw: String
    resp:
      if_success: Int
      token: String
    root: false

  verify_token:
    req:
      token: String
    resp:
      if_success: Int
      new_token: String
    root: false
  

group_list:
  get_notes_mata: # 获取笔记列表，{id, name}[]
    req:     
    resp:
      node_id_name_list: Array
    root: false
  create_new_note:
    req:
    resp:
    root: true

  rename_note:
    req:
      noteid: String
      name: String
    resp:
    root: true

group_content:
  get_note_mata: # 获取笔记元数据信息，获取区块范围，下一个笔记的id
    req:
      noteid: String
    resp:
      next_noteid: Int
      max_chunkx: Int # 两个边界都取得到
      max_chunky: Int # 两个边界都取得到
      min_chunkx: Int # 两个边界都取得到
      min_chunky: Int # 两个边界都取得到
    root: false

  get_chunk_note_ids: # 获取一个区块范围内的笔记id
    req:
      noteid: String
      chunkx: Int
      chunky: Int
    resp:
      noteids: Array
    root: false

  get_note_bar_info:
    req:
      noteid: String
      notebarid: String
    resp:
      x: Float
      y: Float
      w: Float
      h: Float
      text: String
      formatted: String
      connected: Array # [id1,id2...]
      epoch: Int
    root: false

  create_new_bar:
    req:
      noteid: String
      x: Float
      y: Float
    resp:
      chunkx: Int
      chunky: Int
      noteids: Array
    root: true

  update_bar_content:
    req:
      noteid: String
      barid: String
      text: String
      formatted: String
    resp:
      new_epoch: Int
    root: true

  update_bar_transform:
    req:
      noteid: String
      barid: String
      x: Float
      y: Float
      w: Float
      h: Float
    resp: # 移动可能导致区块范围变化
      new_epoch: Int
      chunk_maxx: Int # 两个边界都取得到
      chunk_minx: Int # 两个边界都取得到
      chunk_maxy: Int # 两个边界都取得到
      chunk_miny: Int # 两个边界都取得到
      chunk_change: Array # 从区块0->区块1
    root: true

  redo:
    req:
      noteid: String
    resp:
      redotype: String
      redovalue: Obj
    root: true

  add_path:
    req:
      noteid: String
      from: String
      to: String
    resp:
      _1succ_0fail: Int
      new_epoch_from: Int
      new_epoch_to: Int
    root: true

  get_path_info:
    req:
      noteid: String
      pathid_with_line: String
    resp:
      type_: Int
    root: false

  set_path_info:
    req:
      noteid: String
      pathid_with_line: String
      type_: Int
    resp:
    root: true

  remove_path:
    req:
      noteid: String
      pathid_with_line: String
    resp:
      new_epoch_from: Int
      new_epoch_to: Int
    root: true

  delete_bar:
    req:
      noteid: String
      barid: String
    resp:
      chunk_maxx: Int
      chunk_minx: Int
      chunk_maxy: Int
      chunk_miny: Int
    root: true

  article_binder:
    req:
      bind_unbind_rename: String
      article_name: String
      barid: String
      noteid: String
    resp:
      if_success: Int
    root: true

  article_list:
    req:
      noteid: String
    resp:
      if_success: Int
      list: Array
    root: false

  fetch_all_note_bars_epoch:
    req:
      noteid: String
    resp:
      bars_id_and_epoch: Array
    root: false
